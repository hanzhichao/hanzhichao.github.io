	<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>uc-checker,UI自动化测试框架分享 | 韩志超</title>
  <meta name="author" content="Han Zhichao">
  
  <meta name="description" content="测试开发">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="uc-checker,UI自动化测试框架分享"/>
  <meta property="og:site_name" content="韩志超"/>

  
  
		<!-- favicon -->
		<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
		<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
		<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
		<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
		<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
		<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
		<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
		<link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
		<link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
		<link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.png">
		<meta name="theme-color" content="#009688">
		<!-- favicon end -->
    <!-- <link href="/favicon.ico" rel="icon"> -->
  

  <!-- toc -->
  <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css">

  <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">

  <!-- material design -->
	<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css">
  <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
	<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  

  

  <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/libs/jquery-2.0.3.min.js" type="text/javascript"><\/script>')</script>

</head>

 	<body>
	  <nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">菜单</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">韩志超</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="/" title="">
                    <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                <li>
                    <a href="/archives" title="">
                    <i class=""></i>存档
                    </a>
                </li>
                
                <li>
                    <a href="/categories" title="">
                    <i class="fa fa-list"></i>分类
                    </a>
                </li>
                
                <li>
                    <a href="/about" title="">
                    <i class="fa fa-info-circle"></i>关于
                    </a>
                </li>
                
                <li>
                    <a href="/atom.xml" title="这是一个订阅源">
                    <i class="fa fa-rss"></i>RSS
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

	  <div class="container" >
	    <div class="row">
	
	<div class="col-md-9 center-content">
	

		<div class="content">
			<!-- index -->
		   

			  		<h2>uc-checker,UI自动化测试框架分享</h2>
					
					<div>
						<span class="post-time">2017-12-21 15:30:05</span>
					</div>	
					

					<div class="article-content">
						<blockquote>
<p>北京麻辣诱惑有限公司 信息技术部 测试组 韩志超</p>
</blockquote>
<h2 id="UI自动化测试的意义"><a href="#UI自动化测试的意义" class="headerlink" title="UI自动化测试的意义"></a>UI自动化测试的意义</h2><ol>
<li>验证页面交互的一致性</li>
<li>验证前后端分离项目验证前端数据的正确性</li>
<li>补充覆盖接口测试无法覆盖的业务场景</li>
</ol>
<h2 id="UI自动化测试的策略"><a href="#UI自动化测试的策略" class="headerlink" title="UI自动化测试的策略"></a>UI自动化测试的策略</h2><ol>
<li>验证所有页面是否都能正常显示</li>
<li>验证核心业务流程，如下单，查询订单，开具发票，申购，调拨，盘点等</li>
</ol>
<h2 id="测试框架的本质及实现要点"><a href="#测试框架的本质及实现要点" class="headerlink" title="测试框架的本质及实现要点"></a>测试框架的本质及实现要点</h2><h3 id="测试框架的本质"><a href="#测试框架的本质" class="headerlink" title="测试框架的本质"></a>测试框架的本质</h3><ol>
<li>对重复的操作进行封装</li>
<li>有效的组织，配置、用例、数据、报告等</li>
</ol>
<h3 id="测试框架的实现要点"><a href="#测试框架的实现要点" class="headerlink" title="测试框架的实现要点"></a>测试框架的实现要点</h3><ol>
<li>稳定，健壮性</li>
<li>易用，可配置，兼容性</li>
<li>运行控制，灵活性，效率</li>
<li>方便debug，日志，截图，报告及邮件</li>
<li>参数化</li>
</ol>
<h3 id="UI自动化测试基础框架对比"><a href="#UI自动化测试基础框架对比" class="headerlink" title="UI自动化测试基础框架对比"></a>UI自动化测试基础框架对比</h3><blockquote>
<p>由于QTP只支持IE和Firefox,且为商业工具，方案选择时选择了selenium + python<br>基础框架对比基于python单元测试框架:unittest,nose,pytest 及 robot framework(RF)</p>
</blockquote>
<table>
<thead>
<tr>
<th>对比项</th>
<th>unittest</th>
<th>nose</th>
<th>pytest</th>
<th>RF</th>
</tr>
</thead>
<tbody>
<tr>
<td>执行器</td>
<td>无</td>
<td>nosetest</td>
<td>pytest/py.test</td>
<td>pybot</td>
</tr>
<tr>
<td>discover</td>
<td>支持<br>用例类需要继承unittest.TestCase</td>
<td>支持<br>模块/类/用例以test/Test开头</td>
<td>支持<br>同nose</td>
<td>支持</td>
</tr>
<tr>
<td>skip/make fail</td>
<td>@unittest.skip()<br>@unittest.skipIf()<br>…</td>
<td>from nose.plugins.skip import SkipTest<br>raise SkipTest</td>
<td>@pytest.mark.skipif()<br>@pytest.mark.xfail</td>
<td>无</td>
</tr>
<tr>
<td>fixture</td>
<td>setUp/tearDown<br>setUpClass/tearDownClass<br>setUpMoudle/tearDownMoudle</td>
<td>同unittest(继承unittest.TestCase类)<br>使用装饰器）</td>
<td>@pytest.fixture(session=”session”autouser=True)<br>作用域支持function\module\session<br>autouser=Ture默认执行</td>
<td>[SetUp] … <br>[Teardown]… 支持project,suite,case作用域</td>
</tr>
<tr>
<td>参数化</td>
<td>无</td>
<td>无</td>
<td>@pytest.mark.parametrize(“a,b,expected”, testdata)</td>
<td>[Template] 1 2 3</td>
</tr>
<tr>
<td>tags</td>
<td>无</td>
<td>attrib标签<br>from nose.plugins.attrib import attr<br>@attr(type=’smoke’)<br>def test_demo1():<br>…<br>nostests -a type=smoke</td>
<td>@pytest.mark.smoke<br>pytest -m smoke</td>
<td>[Tags] smoke<br>pybot -i/-e smoke</td>
</tr>
<tr>
<td>timeout/time limit</td>
<td>无</td>
<td>from nose.tools import timed<br>@timed(30)<br>def test_demo()…</td>
<td>pip install pytest-timeout<br>@pytest.mark.timeout(30)或pytest –timeout=30</td>
<td>[Timeout]  30 seconds</td>
</tr>
<tr>
<td>list case</td>
<td>无</td>
<td>nosetests –collect-only</td>
<td>pytest -v –collect-only</td>
<td>未知</td>
</tr>
<tr>
<td>rerun fail case</td>
<td>无</td>
<td>nosetests –failed</td>
<td>pip install pytest-rerunfailures<br>@pytest.mark.flaky(rerun=1)或pytest –rerun=1</td>
<td>robot –rerunfailed</td>
</tr>
<tr>
<td>log</td>
<td>无</td>
<td>支持，运行参数</td>
<td>支持，运行参数</td>
<td>支持，自动生成log和出错截图</td>
</tr>
<tr>
<td>xml报告/Jenkins集成</td>
<td>无</td>
<td>nosetests –with-xunit –xunit-file=支持allure报告<br>pip install pytest-nose-adaptor</td>
<td>pytest –junit-xml=<br>支持allure报告<br>pip install pytest-allure-adaptor</td>
<td>支持，自动生成</td>
</tr>
<tr>
<td>html报告</td>
<td>三方HtmlTestRunner(python2.0)</td>
<td>pip install nose-htmloutput<br>nosetests –with-html –html-file=</td>
<td>pip install pytest-html<br>pytest –html=</td>
<td>支持，自动生成</td>
</tr>
<tr>
<td>baseline对比</td>
<td>无</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>发送email</td>
<td>无</td>
<td>无</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>并发/多线程</td>
<td>无</td>
<td>无</td>
<td>无</td>
<td>无</td>
</tr>
<tr>
<td>Selenium支持</td>
<td>原生库</td>
<td>原生库</td>
<td>pytest-selenium</td>
<td>robotframework-seleniumlibrary<br>robotframework-selenium2library</td>
</tr>
</tbody>
</table>
<p><strong> 选择unittest,是因为其为python的核心库，提供了用例组织的基础功能，二次开发的灵活性更好 </strong></p>
<h2 id="框架结构及要点实现原理"><a href="#框架结构及要点实现原理" class="headerlink" title="框架结构及要点实现原理"></a>框架结构及要点实现原理</h2><blockquote>
<p>基于 python2/3 + unittest + selenium<br>需要安装Chrome</p>
</blockquote>
<h3 id="框架结构"><a href="#框架结构" class="headerlink" title="框架结构"></a>框架结构</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-ui_checker                                         ---项目目录</span><br><span class="line">    -conf                                           ---配置文件目录</span><br><span class="line">        default.conf</span><br><span class="line">    -data                                           ---数据文件目录</span><br><span class="line">        test_customer_ccustomer_index<span class="selector-class">.ini</span>           ---数据文件</span><br><span class="line">    -driver                                         ---浏览器驱动目录</span><br><span class="line">    -page_obj                                       ---页面对象目录</span><br><span class="line">        base_page<span class="selector-class">.py</span>                                ---页面对象原型</span><br><span class="line">        -customer                                   ---模块</span><br><span class="line">            -CCustomer                              ---子模块</span><br><span class="line">                index<span class="selector-class">.py</span>                            ---页面对象</span><br><span class="line">                index<span class="selector-class">.property</span>                      ---页面元素</span><br><span class="line">    -report                                         ---运行报告目录</span><br><span class="line">        -log                                        ---报告目录</span><br><span class="line">        -snapshot                                   ---截图目录</span><br><span class="line">        customer_2017-<span class="number">11</span>-<span class="number">29</span>_162338_result<span class="selector-class">.html</span>      ---测试报告</span><br><span class="line">    -test_case                                      ---测试用例目录</span><br><span class="line">        base_case<span class="selector-class">.py</span>                                ---用例原型</span><br><span class="line">        -customer</span><br><span class="line">            test_ccustomer_index<span class="selector-class">.py</span>                 ---测试用例</span><br><span class="line">    -tools                                          ---其他工具目录</span><br><span class="line">    -util                                           ---公共方法目录</span><br><span class="line">        browser<span class="selector-class">.py</span>                                  ---封装浏览器对象，支持Chrome Headless和Grid分布式</span><br><span class="line">        config<span class="selector-class">.py</span>                                   ---解析default.conf配置</span><br><span class="line">        data_file_parser<span class="selector-class">.py</span>                         ---解析各种数据文件</span><br><span class="line">        db<span class="selector-class">.py</span>                                       ---数据库操作封装</span><br><span class="line">        decorator<span class="selector-class">.py</span>                                ---运行控制装饰器</span><br><span class="line">        HTMLTestRunnerCN<span class="selector-class">.py</span>                         ---生成报告，美化页面，支持python2/<span class="number">3</span></span><br><span class="line">        log<span class="selector-class">.py</span>                                      ---log配置</span><br><span class="line">        option_parser<span class="selector-class">.py</span>                            ---run_all_test 运行参数解析</span><br><span class="line">        root<span class="selector-class">.py</span>                                     ---解析项目目录，用于拼装绝对路径</span><br><span class="line">        selenium_easy<span class="selector-class">.py</span>                            ---基于xpath,增加元素定位及操作方法</span><br><span class="line">    run_all_test<span class="selector-class">.py</span>                                 ---执行入口文件</span><br></pre></td></tr></table></figure>
<h3 id="要点实现原理"><a href="#要点实现原理" class="headerlink" title="要点实现原理"></a>要点实现原理</h3><ol>
<li>健壮性—采用PageObject模式，页面对象与元素分离，元素写到单独的文件中</li>
<li>易用—封装页面对象原型和用例原型，通过继承简化操作，selenium_easy模式</li>
<li>效率—Chrome Headless模式，按模块多线程并发</li>
<li>参数化—通过python装饰器实现，数据文件采用config文件，支持多组数据<br>装饰器<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">data</span><span class="params">(data_file, section=<span class="string">'default'</span>)</span></span>:    <span class="comment"># 使用该装饰器的方法必须具有data参数</span></span><br><span class="line">    data_path = <span class="string">'../data/'</span></span><br><span class="line">    _data_file = data_path + data_file + <span class="string">".config"</span></span><br><span class="line">    data = ConfFile.load_section(_data_file, section)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_data</span><span class="params">(func)</span></span><span class="symbol">:</span></span><br><span class="line">        @wraps(func)</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">wrapper</span><span class="params">(*_args, **_kwargs)</span></span><span class="symbol">:</span></span><br><span class="line">            _kwargs[<span class="string">'data'</span>]=data</span><br><span class="line">            <span class="keyword">return</span> func(*_args, **_kwargs)</span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> _data</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>数据文件 test_customer_ccustomer_index.ini<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[customer_not_exists]</span></span><br><span class="line"><span class="attr">phone</span>=<span class="number">18010181268</span></span><br></pre></td></tr></table></figure></p>
<p>用例<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@data(<span class="string">'test_customer_ccustomer_index'</span>,<span class="string">'customer_not_exists'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_search_not_exist_customer</span><span class="params">(<span class="keyword">self</span>,data)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">self</span>.search_phone(data[<span class="string">'phone'</span>])</span><br></pre></td></tr></table></figure></p>
<ol>
<li>方便debug—log及通过装饰器，显示项selenium操作时间</li>
<li>用例执行<br>6.1. 用例level(tags)<br>装饰器<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">level</span><span class="params">(level)</span>:</span></span><br><span class="line">    test_level = Config.option(<span class="string">'runtime'</span>,<span class="string">'test_level'</span>)   <span class="comment"># 通过配置文件中的test_level控制</span></span><br><span class="line">    <span class="keyword">if</span> test_level == <span class="number">0</span> <span class="keyword">or</span> test_level == level:</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">lambda</span> func: func</span><br><span class="line">    <span class="keyword">return</span> unittest.skip(<span class="string">"skip this level cases"</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>配置文件 default.con<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[runtime]</span><br><span class="line"><span class="attribute">test_level</span>=1  # 默认<span class="attribute">test_level</span>=0 ，执行所有用例</span><br></pre></td></tr></table></figure></p>
<p>用例<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@level</span>(<span class="number">1</span>)</span><br><span class="line"><span class="variable">@data</span>(<span class="string">'test_customer_ccustomer_index'</span>,<span class="string">'customer_not_exists'</span>)</span><br><span class="line">def test_search_not_exist_customer(self,data):</span><br><span class="line">    self.search_phone(data[<span class="string">'phone'</span>])</span><br></pre></td></tr></table></figure></p>
<p>6.2. timeout控制—装饰器(略)<br>6.3. 命令行参数解析—option_parser</p>
<ol>
<li>数据对比—在页面配置文件中配好各元素的db_map，支持db_compare_all</li>
<li>环境清理—需要自行调用db.py中的exec_sql方法，通过执行sql清理环境</li>
</ol>
<h2 id="主要特性"><a href="#主要特性" class="headerlink" title="主要特性"></a>主要特性</h2><ol>
<li>采用PageObject模式封装每个操作页面，支持页面与元素分离</li>
<li>支持selenium_easy模式，按人类习惯，通过链接/按钮文字，Form前置标签识别/操作控件，支持多个相同标签控件的识别</li>
<li>支持Json/XML/CSV/Excel/Config类型的数据文件解析，支持将数据文件完整解析成dict格式，或从中获取某个值</li>
<li>支持数据连接及对比数据库的值</li>
<li>支持Chrome Headless无界面模式运行，支持Grid分布式运行或Remote模式</li>
<li>支持按模块并发执行用例，每个模块生成各自的报告</li>
<li>支持邮件/截图/log</li>
<li>支持显示webdriver各项操作消耗时间，支持time_out设置，支持多线程重复某一操作， 支持制定test case level</li>
<li>支持 Windows/Linux + python2.<em>/python3.</em> </li>
</ol>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><h3 id="运行环境"><a href="#运行环境" class="headerlink" title="运行环境"></a>运行环境</h3><blockquote>
<p>推荐 Windows 7/10 + Python 3.<em> + selenium3.5 + Chrome 62以上<br>或 CentOS 7.</em> + Python2.7 + selenium3.5 + google-chrome-stable最新版</p>
</blockquote>
<p>以Windows为例：</p>
<ol>
<li>下载安装Chrome最新版</li>
<li>下载安装Git Windows客户端</li>
<li>下载安装python3.6.3（自动安装pip和配置好环境变量）</li>
<li>安装python第三方库，打开cmd<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pip <span class="keyword">install</span> selenium</span><br><span class="line">pip <span class="keyword">install</span> pymysql</span><br><span class="line">pip <span class="keyword">install</span> xlrd</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="使用项目"><a href="#使用项目" class="headerlink" title="使用项目"></a>使用项目</h3><ol>
<li><p>克隆项目，打开cmd</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git<span class="variable">@192</span>.<span class="number">168.100</span>.<span class="number">240</span><span class="symbol">:hanzhichao/ui_checker</span>.git</span><br><span class="line">cd ui_checker</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置项目</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">打开conf/<span class="keyword">default</span>.conf</span><br><span class="line">修改[env]下base_url及登录用户名和密码,保存</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行所有用例</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">python</span> run_all_test.<span class="keyword">py</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="编写用例"><a href="#编写用例" class="headerlink" title="编写用例"></a>编写用例</h3><ol>
<li><p>完善page_obj对象</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.1</span> 根据页面菜单url确定所在模块，如<span class="string">"综合管理系统&gt;部门管理&gt;新增部门"</span> 页面链接为.../admin/ADepartment/create</span><br><span class="line"><span class="number">1.2</span> 打开page_obj/目录下对应的模块下对应的<span class="keyword">py</span>文件，如page_obj/admin/ADepartment/create.<span class="keyword">py</span></span><br><span class="line"><span class="number">1.3</span> 完善<span class="keyword">menu</span>和subject：</span><br><span class="line">    如<span class="keyword">menu</span>=<span class="string">'综合管理系统'</span>,<span class="string">'部门管理'</span>,<span class="string">'新增部门'</span>（用于加载页面，注意：中间为英文逗号），</span><br><span class="line">    subject=<span class="string">'部门信息'</span>（页面主体，第一个头部主题，用于判断页面是否加载成功）</span><br><span class="line"><span class="number">1.4</span> 封装页面操作，<span class="number">3</span>种方式，参考page_obj/customer/CCustumer/下的：</span><br><span class="line">    <span class="built_in">index</span>.<span class="keyword">py</span>(selenium_easy模式)</span><br><span class="line">    index2.<span class="keyword">py</span>(标准PageObj模式)</span><br><span class="line">    index3.<span class="keyword">py</span>+index3.property(元素分离模式)</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写测试用例</p>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">进入test<span class="number">_</span><span class="keyword">case</span>/相应模块下，如test<span class="number">_</span><span class="keyword">case</span>/admin</span><br><span class="line">新建test<span class="number">_</span>adepartment<span class="number">_</span>create.py文件</span><br><span class="line">编写该页面相关的用例，参考test<span class="number">_</span><span class="keyword">case</span>/customer/test<span class="number">_</span>ccustomer<span class="number">_</span>index.py</span><br></pre></td></tr></table></figure>
</li>
<li><p>page_obj示例</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># !/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding=utf-8 -*-</span></span><br><span class="line"></span><br><span class="line">from time import sleep</span><br><span class="line"></span><br><span class="line">from page_obj.base_page import BasePage</span><br><span class="line">from page_obj.index.index.login import LoginPage</span><br><span class="line">from util.browser import Chrome</span><br><span class="line">from util.db import DB</span><br><span class="line">from util.selenium_easy import Element, Input</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IndexPage</span>(<span class="title">BasePage</span>):</span></span><br><span class="line">    menu = (<span class="string">'客服管理系统'</span>, <span class="string">'综合管理'</span>, <span class="string">'综合信息'</span>)</span><br><span class="line">    subject = <span class="string">'会员信息'</span></span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search_phone</span><span class="params">(<span class="keyword">self</span>, phone)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.type(<span class="string">'电话搜索：'</span>, phone)</span><br><span class="line">        <span class="keyword">self</span>.click_btn(<span class="string">'搜索'</span>)</span><br><span class="line">        <span class="keyword">self</span>.sleep()</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save_work_bill</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.click(<span class="string">"显示更多内容"</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">self</span>.select(<span class="string">"来电原由"</span>, <span class="string">"订单"</span>)</span><br><span class="line">        <span class="keyword">self</span>.select(<span class="string">"来电原由"</span>, <span class="string">"创建订单"</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">self</span>.type_area(<span class="string">"备注"</span>, <span class="string">"自动化测试"</span>, <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">self</span>.click_btn(<span class="string">"保存"</span>, <span class="number">2</span>)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_order</span><span class="params">(<span class="keyword">self</span>, phone, station, code)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.search_phone(phone)</span><br><span class="line">        <span class="keyword">self</span>.save_work_bill()</span><br><span class="line">        <span class="keyword">self</span>.click(<span class="string">"显示更多内容"</span>, <span class="number">4</span>)</span><br><span class="line">        <span class="keyword">self</span>.select(<span class="string">"配送站点"</span>, station)</span><br><span class="line">        <span class="keyword">self</span>.type(<span class="string">"请输入要查询商品的简码"</span>, code)</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">self</span>.click_text(<span class="string">"麻酱烧饼"</span>)</span><br><span class="line">        <span class="keyword">self</span>.select(<span class="string">"订单渠道："</span>, <span class="string">"电话"</span>)</span><br><span class="line">        <span class="keyword">self</span>.select(<span class="string">"订单区域"</span>, <span class="string">"北京"</span>)</span><br><span class="line">        <span class="keyword">self</span>.click_input(<span class="string">"是否预定送餐时间"</span>, <span class="number">4</span>)</span><br><span class="line">        <span class="keyword">self</span>.click_btn(<span class="string">"当前"</span>)</span><br><span class="line">        <span class="keyword">self</span>.click_btn(<span class="string">"确认"</span>)</span><br><span class="line">        <span class="keyword">self</span>.check(<span class="string">"支付方式"</span>, <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">self</span>.select(<span class="string">"支付方式"</span>, <span class="string">"支付宝"</span>)</span><br><span class="line">        <span class="keyword">self</span>.type_area(<span class="string">"备注"</span>, <span class="string">"自动化测试下单"</span>, <span class="number">3</span>)</span><br><span class="line">        <span class="keyword">self</span>.click_btn(<span class="string">"保存"</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>测试用例示例<br>test_case/customer/test_ccustomer_index.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">sys.path.append(<span class="string">".."</span>)</span><br><span class="line"><span class="keyword">from</span> page_obj.customer.CCustomer.index <span class="keyword">import</span> IndexPage</span><br><span class="line"><span class="keyword">from</span> test_case.base_case <span class="keyword">import</span> BaseCase</span><br><span class="line"><span class="keyword">from</span> util.decorator <span class="keyword">import</span> data,level</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestCcustomerIndex</span><span class="params">(BaseCase)</span>:</span></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUpClass</span><span class="params">(cls)</span>:</span></span><br><span class="line">        super(TestCcustomerIndex, cls).setUpClass()</span><br><span class="line">        cls.page = IndexPage(cls.driver)</span><br><span class="line">        cls.page.load()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_search_exist_customer</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        pre-condition: 18010181267 customer exists</span></span><br><span class="line"><span class="string">        no cleaning need</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        phone = <span class="string">'18010181267'</span></span><br><span class="line">        self.page.search_phone(phone)</span><br><span class="line">        <span class="comment"># assert page_obj value and search value</span></span><br><span class="line">        customer_phone = self.page.get_input_value(<span class="string">'会员电话：'</span>)</span><br><span class="line">        self.assertEqual(customer_phone, phone)</span><br><span class="line"></span><br><span class="line"><span class="meta">    @level(1)</span></span><br><span class="line"><span class="meta">    @data(test_customer_ccustomer_index)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_search_not_exist_customer</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">            pre-condition: 18010181261 customer not exists</span></span><br><span class="line"><span class="string">            no cleaning need</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        phone = <span class="string">'18010181261'</span></span><br><span class="line">        self.page.search_phone(phone)</span><br><span class="line">        customer_phone = self.page.get_input_value(<span class="string">'会员电话：'</span>)</span><br><span class="line">        self.assertFalse(customer_phone)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:  </span><br><span class="line">    unittest.main(verbosity=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h2 id="Future"><a href="#Future" class="headerlink" title="Future"></a>Future</h2><ol>
<li>切换到robot framework, 和收银机UI自动化项目保持一致</li>
<li>绿色化，封装依赖环境，优化可移植性</li>
<li>补充主要业务的测试用例</li>
<li>集成数据库对比</li>
<li>集成到jenkin中</li>
</ol>

					</div>

			  <!-- about -->
			  
		</div>

		<!-- pagination -->
	  

		<div class="comment-section">
  
  


</div>
	</div>

	

</div>


		<footer>
			

<p>
  &copy; 2018 <a href="http://yoursite.com"> Han Zhichao </a>
</p>
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	  </div>

		<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>

		<!-- material design -->
		<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script>
		<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>
		<!-- toc -->
		<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
		<script src="/libs/tocify/jquery.tocify.custom.js"></script>

		<script src="/js/main.js"></script>

	</body>
</html>
